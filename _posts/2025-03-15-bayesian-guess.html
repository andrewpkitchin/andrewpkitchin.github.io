---
layout: post
title: "i'm thinking of a number between 1 and 100..."
date: 2025-03-15
permalink: /bayesian-guess1.html
math: true
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bayesian Guessing Game</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 2rem;
      max-width: 800px;
      background-color: #f9f9f9;
      color: #333;
    }
    input, button {
      padding: 0.6rem;
      margin: 0.5rem 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background-color: #007acc;
      color: white;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #005f99;
    }
    canvas {
      max-width: 100%;
      margin-top: 1rem;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .section {
      margin-top: 2rem;
    }
  </style>
</head>
<body>

<h1>guessing with bayes</h1>

<p>
  I'm thinking of a number between 1 and 100. Let's call the number <code>n</code>. Can you guess it?
</p>

<label for="userGuess">What's your guess?</label>
<input type="number" id="userGuess" min="1" max="100" />
<button onclick="recordGuess()">Submit Guess</button>
<p id="guessStatus"></p>

<div class="section">
  <p><strong>Need a clue?</strong></p>
  <p>
    If you want a clue, click the button below. Each time you click, I’ll give you a number between <code>n</code> and 100. 
    You can use these clues to update your belief of how good your guess is. You can also go back and change your guess if you like.
  </p>
  <button onclick="giveClue()">Get a Clue</button>
  <p id="clueOutput"></p>
</div>

<canvas id="beliefChart" width="600" height="400"></canvas>

<div class="section">
  <p>
    The graph shows the probabilities of what <code>n</code> might be. This is updated each time you get a new clue. 
    We start by assuming every number is equally likely - this is called a uniform prior. After each clue, we apply Bayes’ rule 
    to update the distribution of probabilities.
  </p>
  <p>
    Here's the details of what's going on.
    <br><br>
    Our prior belief is that all numbers are equally likely, so each number has a probability of 1% of actually being <code>n</code>. Now you get a clue, say <code>c</code>.
    <br><br>
    For each possible number <code>i</code> (from 1 to 100), you compute the likelihood <code>P(c | n = i)</code>. 
    Since the clue is a number between <code>n</code> and 100, we know:
    <ul>
      <li>If <code>i > c</code>, then <code>P(c | n = i) = 0</code>, because the clue can't be less than <code>n</code>.</li>
      <li>If <code>i ≤ c</code>, then <code>P(c | n = i) = 1 / (100 - i + 1)</code>, since the clue is uniformly sampled from <code>[i, 100]</code>.</li>
    </ul>
    Multiply each prior by its corresponding likelihood. For example, for <code>i = 40</code> and <code>c = 60</code>:
    $$
    P(n = 40 | c = 60) \propto P(c = 60 | n = 40) \cdot P(n = 40) = \frac{1}{61} \cdot \frac{1}{100}
    $$
    Then normalize:
    $$
    P(n = i | c = 60) = \frac{P(c = 60 | n = i) \cdot P(n = i)}{\sum_{j=1}^{100} P(c = 60 | n = j) \cdot P(n = j)}
    $$
  </p>
</div>

<div class="section">
  <button onclick="revealNumber()">Reveal the Number</button>
  <p id="revealOutput"></p>
</div>

<script>
  let secretNumber = Math.floor(Math.random() * 100) + 1;
  let userGuess = null;
  let clues = [];

  let belief = Array(100).fill(1 / 100);

  const ctx = document.getElementById('beliefChart').getContext('2d');
  const chart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: Array.from({length: 100}, (_, i) => i + 1),
      datasets: [{
        label: 'Probability of a guess being correct',
        data: belief,
        backgroundColor: 'rgba(54, 162, 235, 0.7)'
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
          max: 1
        }
      }
    }
  });

  function recordGuess() {
    const val = parseInt(document.getElementById('userGuess').value);
    if (isNaN(val) || val < 1 || val > 100) {
      document.getElementById('guessStatus').textContent = "Please enter a number between 1 and 100.";
    } else {
      userGuess = val;
      document.getElementById('guessStatus').textContent = `Thanks! You've guessed: ${val}`;
    }
  }

  function giveClue() {
    const clue = Math.floor(Math.random() * (101 - secretNumber)) + secretNumber;
    clues.push(clue);
    document.getElementById('clueOutput').textContent = `The clue is: ${clue}`;

    let newBelief = [];
    let total = 0;
    for (let i = 1; i <= 100; i++) {
      let likelihood = (i <= clue) ? 1 / (101 - i) : 0;
      let updated = belief[i - 1] * likelihood;
      newBelief.push(updated);
      total += updated;
    }

    belief = newBelief.map(p => p / total);
    chart.data.datasets[0].data = belief;
    chart.update();
  }

  function revealNumber() {
    let message = `The number I was thinking of was: ${secretNumber}.`;
    if (userGuess !== null) {
      const diff = Math.abs(userGuess - secretNumber);
      if (diff === 0) {
        message += " Perfect guess!";
      } else if (diff <= 5) {
        message += " Very close!";
      } else if (diff <= 15) {
        message += " Not bad!";
      } else {
        message += " Quite far off!";
      }
    } else {
      message += " You didn't make a guess.";
    }
    document.getElementById('revealOutput').textContent = message;
  }
</script>

</body>
</html>
